<div class="mt-3" id="calendar-show">

  <a href="#" class="go-top">
    <%= icon 'arrow-up-circle' %>
  </a>

  <div class="mt-3 text-center">
    <div class="table-header">
      <h2>
        <%= t('navigation.calendar').upcase %>
      </h2>
    </div>

    <div class="input-group d-flex justify-content-around">
      <%= render 'layouts/search', path: calendar_path %>
      <%= canvas_button 'goal_markers', klass: 'mt-3 mx-1' %>

      <div class="date_select d-flex justify-content-around">
        <%= form_with url: calendar_path, method: :get, class: 'd-flex mt-3' do |f| %>
          <%= f.date_field :start_date, value: "#{params[:start_date].present? ? params[:start_date] : Date.today}",
                           class: 'form-control' %>
          <%= f.submit t('search'), default: 'Go', class: 'btn btn-primary btn-sm action mx-1' %>
        <% end %>
      </div>
    </div>
  </div>


  <%= month_calendar do |date| %>
    <%= date %>
    <% habits_for.each do |habit| %>
      <% if habit.completion_dates.any? { |cd| cd.date == date.to_date } %>
        <div class="completed border border-dark"
             style="background: linear-gradient(
               to right,
                 <%= habit.goal.color %> 7%,
                 rgba(24, 225, 68, 0.5) 0%);">
          <%= habit.name %>
        </div>
      <% else %>
        <div class="uncompleted border border-dark"
             style="background: linear-gradient(
               90deg,
                 <%= habit.goal.color %> 7%,
                 rgba(239, 22, 22, 0.5) 0%);">
          <%= habit.name %>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>

<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasExample"><%= t('goal_markers') %></h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <div class="offcanvas-body">
    <div class="table-body">
      <table class="table table-hover">
        <thead class="table-light">
        <tr>
          <th scope="col">#</th>
          <th scope="col"><%= t('activerecord.attributes.goal.name') %></th>
          <th scope="col"><%= t('activerecord.attributes.goal.color') %></th>
        </tr>
        </thead>
        <tbody class="overflow-y-auto">
        <% @goals.each_with_index do |goal, index| %>
          <tr>
            <th scope="row"><%= index + 1 %></th>
            <td><%= goal.name %></td>
            <td style="background-color: <%= goal.color %>;"></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>

</div>

